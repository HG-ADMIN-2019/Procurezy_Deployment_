<!--Display details of a Document-->

{% extends 'root/base.html' %}
{% load static %}
{% block title %} Details of the Document {% endblock %}

{% block maincontent %}
<style>
    .table td {
        padding: 1.5rem;
        vertical-align: top;
        border-top: 1px solid #dee2e6;
    }
</style>
<div class="container-fluid">
    <div id="button" class="mo-doc-button-container">
        <!--Display header based on document type-->
        {% for header_data in header_details %}
        {% if type == 'SC' %}
        <h3>&nbsp;&nbsp;Shopping Cart #{{ header_data.doc_number }}</h3>
        {% endif %}
        {% if type == 'PO' %}
        <h3>&nbsp;&nbsp;Details of Purchase Order</h3>
        {% endif %}
        {% if type == 'CONF' %}
        <h3>&nbsp;&nbsp;Details of Confirmation</h3>
        {% endif %}
        {% endfor %}
        <div class="d-flex">
            <div id="on_page_load">
                {% if hdr_det.status == 'SAVED' %}
                <div class="mo-doc-button-group__saved">
                    <button type="button" class="btn btn-outline-primary" onclick="window.close()"><i class="fas fa-times"></i> Close</button>
                </div>
                {% else %}
                <div class="mo-doc-button-group__saved" >
                    <button type="button" class="btn btn-outline-primary" onclick="window.close()"><i class="fas fa-times"></i> Close</button>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="mo-doc-body-wrapper">

        <!--Display Header Details-->
        <div class="mo-doc-header">
            <div class="card card-shadow-1">
                <div class="card-body mo-doc-header__doc-details" id="header_div">
                    <div class="header-details">
                        <div style="font-weight:normal;" hidden>Header Details&nbsp;&nbsp;</div>
                    </div>
                    <div>
                        <!--Display Attachments and POPDF buttons if type is PO-->
                        <div>
                            {% if type == 'PO' %}
                            <a target="_blank" href="{% url 'eProc_Archiving:attach_page' guid %}"><button type="button" title = "Click here to get Documents! " >PO PDF & Attachments</button></a>
                            {% endif %}
                        </div>
                    </div>

                    <div>
                        <div>
                            <table class="table-sm" style="margin:0px 10px 0px 10px; width:98%;">
                                <thead style="color:#00000080; font-size:16px; font-style:normal; font-weight: 600;">
                                <tr>
                                    <th scope="col">Document Name</th>
                                    {% if type == 'SC' %}
                                    <th scope="col">Document Number</th>
                                    {% elif type == 'PO' %}
                                    <th scope="col">PO Number</th>
                                    {% else %}
                                    <th scope="col">Confirmation Number</th>
                                    <th scope="col">PO Number</th>
                                    {% endif %}
                                    <th scope="col">Created On</th>
                                    <th scope="col">Created By</th>
                                    <th scope="col">Status</th>
<!--                                    <th scope="col">Total Value</th>-->
<!--                                    <th scope="col">Currency</th>-->
<!--                                    <th scope="col">Requester</th>-->
<!--                                    <th scope="col">Creator</th>-->
<!--                                    <th scope="col">Changed At</th>-->
<!--                                    <th scope="col">Changed By</th>-->
<!--                                    <th scope="col">Ordered At</th>-->
<!--                                    <th scope="col">Time Zone</th>-->
                                </tr>
                                </thead>
                                <tbody style="font-style: normal; font-weight: 600; font-size: 18px;">
                                {% for header_data in header_details %}
                                <tr>
                                    <td>{{header_data.description}}</td>
                                    <td>{{ header_data.doc_number }}</td>
                                    {% if type == 'CONF' %}
                                    <td><a href="{% url 'eProc_Archiving:document_info' 'PO' header_data.po_doc_number %}" target="_blank">{{ header_data.po_doc_number }}</a></td>
                                    {% endif %}
                                    <td>{{header_data.created_at}}</td>
                                    <td>{{header_data.created_by}}</td>
                                    <td><span class="badge badge-pill badge_status_approved">{{header_data.status}}</span></td>
<!--                                    <td>{{header_data.total_value}}</td>-->
<!--                                    <td>{{header_data.currency}}</td>-->
<!--                                    <td>{{header_data.requester}}</td>-->
<!--                                    <td>{{header_data.changed_at}}</td>-->
<!--                                    <td>{{header_data.changed_by}}</td>-->
<!--                                    <td>{{header_data.ordered_at}}</td>-->
<!--                                    <td>{{header_data.time_zone}}</td>-->
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="mb-4">
            <div class="row no-gutters">
                <div class="col-lg mr-2 ml-2">
                    <div class="card card-shadow-1" style="height:100%;">
                         <div class="card-body">
                             <h5 class="card-title">Shipping Address</h5>
                             <div class="elements-space-between">
                                 <div></div>
                             </div>
                             <br><br><br>
                             <hr>
                             {% for header_data in header_details %}
                             <div class="elements-space-between">
                                 <span class="h6">Receiver : <span style="color:#00000080;">{{header_data.requester}} </span></span>
                             </div>
                             {% endfor %}
                         </div>
                    </div>
                </div>
                <div class="col-lg mr-2 ml-2">
                    <div class="card account-assignment-card card-shadow-1" style="height:100%;">
                        <div class="card-body">
                            <h5 class="card-title">Account Assignment</h5>
                            <div class="elements-space-between">
                                 {% if accounting_details %}
                                    {% with accounting_details.0 as prev_detail %}
                                        {% with accounting_details.0 as accounting_data %}
                                            <div class="mb-2">
                                                {% if prev_detail.acc_cat %}
                                                    <div>
                                                        <span class="h6"> Account Assignment Category : </span>
                                                        {% if accounting_details|length > 1 and prev_detail.acc_cat != accounting_details.1.acc_cat %}
                                                             <span style="color:#212529;">Multiple</span>
                                                        {% else %}
                                                            <span style="color:#212529;">{{ accounting_data.acc_cat }}</span>
                                                            <span class="badge badge-pill badge_primary_acc">Primary</span>
                                                        {% endif %}
                                                    </div>
                                                {% endif %}
                                                {% if prev_detail.dist_perc %}
                                                                <div>
                                                                    <span class="h6"> Distribution Percentage : </span>
                                                                    {% if accounting_details|length > 1 and prev_detail.dist_perc != accounting_details.1.dist_perc %}
                                                                          <span style="color:#212529;">Multiple</span>
                                                                    {% else %}
                                                                         <span style="color:#212529;">{{ accounting_data.dist_perc }}</span>
                                                                    {% endif %}
                                                                </div>
                                                {% endif %}
                                                {% if prev_detail.cost_center %}
                                                                <div>
                                                                    <span class="h6"> Cost Center : </span>
                                                                    {% if accounting_details|length > 1 and prev_detail.cost_center != accounting_details.1.cost_center %}
                                                                         <span style="color:#212529;">Multiple</span>
                                                                    {% else %}
                                                                         <span style="color:#212529;">{{ accounting_data.cost_center }}</span>
                                                                    {% endif %}
                                                                </div>
                                                {% endif %}
                                                {% if prev_detail.generic_acc_ass %}
                                                                <div>
                                                                    <span class="h6"> Generic Account Assignment : </span>
                                                                    {% if accounting_details|length > 1 and prev_detail.generic_acc_ass != accounting_details.1.generic_acc_ass %}
                                                                         <span style="color:#212529;">Multiple</span>
                                                                    {% else %}
                                                                         <span style="color:#212529;">{{ accounting_data.generic_acc_ass }}</span>
                                                                    {% endif %}
                                                                </div>
                                                {% endif %}
                                                {% if prev_detail.internal_order %}
                                                                <div>
                                                                    <span class="h6"> Internal Order : </span>
                                                                    {% if accounting_details|length > 1 and prev_detail.internal_order != accounting_details.1.internal_order %}
                                                                        <span style="color:#212529;">Multiple</span>
                                                                    {% else %}
                                                                        <span style="color:#212529;">{{ accounting_data.internal_order }}</span>
                                                                    {% endif %}
                                                                </div>
                                                {% endif %}
                                                {% if prev_detail.wbs_ele %}
                                                                <div>
                                                                    <span class="h6"> WBS Element : </span>
                                                                    {% if accounting_details|length > 1 and prev_detail.wbs_ele != accounting_details.1.wbs_ele %}
                                                                        <span style="color:#212529;">Multiple</span>
                                                                    {% else %}
                                                                        <span style="color:#212529;">{{ accounting_data.wbs_ele }}</span>
                                                                    {% endif %}
                                                                </div>
                                                {% endif %}
                                                {% if prev_detail.gl_acc_num %}
                                                                <div>
                                                                    <span class="h6"> General Ledger Account : </span>
                                                                    {% if accounting_details|length > 1 and prev_detail.gl_acc_num != accounting_details.1.gl_acc_num %}
                                                                      <span style="color:#212529;"> Multiple </span>
                                                                    {% else %}
                                                                       <span style="color:#212529;">{{ accounting_data.gl_acc_num }}</span>
                                                                    {% endif %}
                                                                </div>
                                                {% endif %}
                                            </div>
                                        {% endwith %}
                                    {% endwith %}
                                {% else %}
                                    <p>No accounting details available.</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--Display Item details-->
        <div class="card mb-4 mr-2 ml-2 card-shadow-1">
            <div class="card-body elements-space-between"><h4>Cart Overview</h4></div>
            <div>
                <div class="mo-items-table">
                    <div class="table-responsive-lg">
<!--                        <div class="header-details">-->
<!--                            <div style="font-weight:normal;">Item Details&nbsp;&nbsp;</div>-->
<!--                        </div>-->
                        <div>
                            <table id="cart_details" class="table mo-item-table">
                                <thead class="thead-light">
                                <tr>
                                    <th scope="col">No</th>
                                    <th scope="col">Description</th>
                                    <th scope="col">Delivery Date</th>
                                    <th scope="col">Price Unit</th>
                                    <th scope="col">Unit</th>
                                    <th scope="col">Quantity</th>
                                    {% if type == 'PO' %}
                                        <th scope="col">SC Number</th>
                                    {% elif type == 'SC' %}
                                        <th scope="col">PO  Number</th>
                                    {% endif %}
                                    <th scope="col">Action</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for item_data in item_details %}
                                <tr>
                                    <td>{{forloop.counter}}</td>
                                    <td>{{item_data.prod_description}}</td>
                                    <td>{{item_data.item_del_date}}</td>
                                    <td>{{item_data.price_unit}}</td>
                                    <td>{{item_data.unit}}</td>
                                    <td>{{item_data.quantity}}</td>
                                    {% if type == 'PO' %}
                                    <td><a href="{% url 'eProc_Archiving:document_info' 'SC' item_data.sc_num %}" target="_blank">{{item_data.sc_num}}</a></td>
                                    {% elif type == 'SC' %}
                                    <td><a href="{% url 'eProc_Archiving:document_info' 'PO' item_data.po_num %}" target="_blank">{{item_data.po_num}}</a></td>
                                    {% endif %}
                                    <td>
                                        <div class="item-action-icon-section">
                                            <div class="action_dropdown dropdown">
                                                <a type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                    <i class="material-icons action_dropdown-icon item-action-icons">more_vert</i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton" style="color:#00000080;">
                                                    <a class="dropdown-item detailingData-{{ forloop.counter }}" onclick="showSection(this, 'detailingData-{{ forloop.counter }}')">Details</a>
                                                    <a class="dropdown-item accoutingData-{{ forloop.counter }}" onclick="showSection(this, 'accoutingData-{{ forloop.counter }}')">Cost Assignment</a>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <!--start of hideable section containing sc item action-->
                                <tr class="item-table-action__section">
                                    <td colspan="14" id="item_info_tr-{{forloop.counter}}" hidden>
                                        <!--Detailing Section-->
                                        <div id="detailingData-{{ forloop.counter }}" style="display: none;" class="item{{ forloop.counter }}">
                                            <div class="card">
                                                <div class="card-header item-table-action__header"><span> Details </span>
                                                    <span onclick="closeAttachSection(this, 'detailingData-{{ forloop.counter }}')">
                                                    <i class="fas fa-times"></i>
                                                    </span>
                                                </div>
                                                <div class="card-body">
                                                    <div class="hg_class_item_data">
                                                        <div class="row">
                                                            <div class="col">
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Item Number: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.item_num}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Company Code: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.comp_code}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Purchasing Group: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.purch_grp}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Supplier ID: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.supplier_id}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Product Category: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.prod_cat}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Catalog ID: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.catalog_id}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col">
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">UNSPSC: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.unspsc}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Price: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.price}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Gross Price: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.gross_price}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Supplier Product Number: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.supp_prod_num}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Status: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.status}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                                <div class="form-group row">
                                                                    <label class="col-4 col-form-label">Goods Recipient: </label>
                                                                    <div class="col-8">
                                                                        <input type="text" class="form-control" value="{{item_data.goods_recep}}" style="background-color: #e9ecef;">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- end of hideable content which lets the user change Detail Section -->
                                        <!-- start of hideable content which lets the user change cost assignment -->
                                        <div id="accoutingData-{{ forloop.counter }}" style="display: none;" class="item{{ forloop.counter }}">
                                            <div class="card">

                                                <div class="card-header item-table-action__header">
                                                    <span>Account assignment category</span>
                                                    <span onclick="closeAttachSection(this, 'accoutingData-{{ forloop.counter }}')">
                                                        <i class="fas fa-times"></i>
                                                    </span>
                                                </div>
                                                 <div class="card-body">
                                                    <div>
                                                        {% for accounting_data in accounting_details %}
                                                             {% if accounting_data.item_guid_id == item_data.guid %}
                                                                <span class="h6">Account Assignment Category :</span>
                                                                <span >{{ accounting_data.acc_cat }}</span><br>
                                                                <span class="h6"> Distribution Percentage : </span>
                                                                <span >{{ accounting_data.dist_perc }}</span><br>
                                                                <span class="h6">Cost Center: </span>
                                                                <span>{{ accounting_data.cost_center }} </span><br>
                                                                <span class="h6"> Generic Account Assignment : </span>
                                                                <span>{{ accounting_data.generic_acc_ass }}</span><br>
                                                                <span class="h6">GL Account Number: </span>
                                                                <span>{{ accounting_data.gl_acc_num }}</span><br>
                                                             {% endif %}
                                                        {% endfor %}
                                                    </div>
                                                 </div>
                                            </div>
                                        </div>
                                        <!-- end of hideable content which lets the user change cost assignment -->
                                    </td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

         <!--  Approval Process overview card section  -->
        <div class="mr-2 ml-2">
            <div class="card card-shadow-1" id="approval_process_overview">
                <div class="card-body">
                    <div>
                        <div id="id_dynamic"></div>
                        <div class="workflow-overview">
                            <div class="card text-dark workflow-overview__process-card" id="workflow_status_div">
                                <div class="card-body">
                                    <span class="h3">Approval Process Overview</span>
                                </div>
                            </div>
                            <div class="workflow-overview__section">
                                <div class="workflow-overview__user-icon-container ao-logged-in-user">
                                    <div class="workflow-user-bg">
                                        <i class="fa fa-user fa-3x" aria-hidden="true"> </i>
                                    </div>
                                    {% for header_data in header_details %}
                                     <button type="button" class="button-workflow-user">{{header_data.requester}}</button>
                                    {% endfor %}
                                </div>
<!--                                <div class="workflow-overview__next-icon-container">-->
<!--                                    <i class="fas fa-angle-double-right fa-3x"></i>-->
<!--                                </div>-->
                                <div id="div_manager_detail" class="workflow-overview__managers-section">
                                    <div class="workflow-overview__next-icon-container">
                                        <i class="fas fa-angle-double-right fa-3x"></i>
                                    </div>
                                    <div class="workflow-overview__user-icon-container">
                                        <div class="workflow-user-bg workflow-completed">
                                            <i class="fas fa-user-check fa-2x icon-workflow-completed" aria-hidden="true"> </i>
                                        </div>
                                        {% for approval_data in approval_details %}
                                        <button id="{{sc_app.guid}}" onclick="show_manager_detail(this.id);" type="button" class="button-workflow-user">{{approval_data.app_id}}</button>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--  start of manager detail pop up-->
<!--        <div class="modal fade show" id="manager-detail-popup" tabindex="-1" style="display: block; padding-right: 22px;" role="dialog">-->
<!--            <div class="modal-dialog modal-dialog-centered modal-xl" role="document">-->
<!--                <div class="modal-content">-->
<!--                    <div class="modal-header">-->
<!--                        <h5 class="modal-title">Financial Approval</h5>-->
<!--                        <button type="button" class="close" data-dismiss="modal" aria-label="close">-->
<!--                            <span aria-hidden="true">x</span>-->
<!--                        </button>-->
<!--                    </div>-->
<!--                    <div class="">-->
<!--                        <table class="table table-bordered" id="manager_detail_table">-->
<!--                            <thead class="thead-light">-->
<!--                                <tr>-->
<!--                                    <th scope="col">Approval Type</th>-->
<!--                                    <th scope="col">Step Number</th>-->
<!--                                    <th scope="col">Process Level Status</th>-->
<!--                                    <th scope="col">Approval Status</th>-->
<!--                                    <th scope="col">Approver</th>-->
<!--                                    <th scope="col">Processed On</th>-->
<!--                                    <th scope="col">Received On</th>-->
<!--                                </tr>-->
<!--                            </thead>-->
<!--                            <tbody id="manager_detail_body">-->
<!--                               {% for approval_data in approval_details %}-->
<!--                                    <tr>-->
<!--                                        <td>{{approval_data.app_desc}}</td>-->
<!--                                        <td>{{approval_data.step_num }}</td>-->
<!--                                        <td>{{approval_data.proc_lvl_sts}}</td>-->
<!--                                        <td>{{approval_data.app_sts}}</td>-->
<!--                                        <td>{{approval_data.app_id}}</td>-->
<!--                                        <td>{{approval_data.proc_time}}</td>-->
<!--                                        <td>{{approval_data.recevied_time}}</td>-->
<!--&lt;!&ndash;                                        <td>{{approval_data.time_zone}}</td>&ndash;&gt;-->
<!--                                    </tr>-->
<!--                                    {% endfor %}-->
<!--                            </tbody>-->
<!--                        </table>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
        <!--Display Accounting details-->

        <div class="header-details">
            <div style="font-weight:normal;">Accounting Details&nbsp;&nbsp;</div>
        </div><br><br>
        <div>
            <table class="table table-striped table-sm" style="margin:0px 10px 0px 10px; width:98%;">
                <thead>
                <tr>

                    <th scope="col">Number</th>
                    <th scope="col">Account Assignment Category</th>
                    <th scope="col">Distribution Percentage</th>
                    <th scope="col">General Ledger Account</th>
                    <th scope="col">Cost Center</th>
                    <th scope="col">Internal Order</th>
                    <th scope="col">Generic Account Assignment</th>
                    <th scope="col">WBS Element</th>

                </tr>
                </thead>
                <tbody>
                {% for accounting_data in accounting_details %}
                <tr>
                    <td>{{accounting_data.acc_item_num }}</td>
                    <td>{{accounting_data.acc_cat}}</td>
                    <td>{{accounting_data.dist_perc}}</td>
                    <td>{{accounting_data.gl_acc_num}}</td>
                    <td>{{accounting_data.cost_center}}</td>
                    <td>{{accounting_data.internal_order}}</td>
                    <td>{{accounting_data.generic_acc_ass}}</td>
                    <td>{{accounting_data.wbs_ele}}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <!--Diaplay approval if show_appr flag is set-->
        {% if show_appr %}

        <div class="header-details">
            <div style="font-weight:normal;">Approval Details</div>
        </div><br><br>
        <div>
            <table class="table table-striped table-sm" style="margin:0px 10px 0px 10px; width:98%;">
                <thead>
                <tr>
                    <th scope="col">Sequence</th>
                    <th scope="col">Agent Discrimination</th>
                    <th scope="col">Level Status</th>
                    <th scope="col">Status</th>
                    <th scope="col">Processor</th>
                    <th scope="col">Received On</th>
                    <th scope="col">Processed On</th>
                    <th scope="col">Timezone</th>

                </tr>
                </thead>
                <tbody>
                {% for approval_data in approval_details %}
                <tr>
                    <td>{{approval_data.step_num }}</td>
                    <td>{{approval_data.app_desc}}</td>
                    <td>{{approval_data.proc_lvl_sts}}</td>
                    <td>{{approval_data.app_sts}}</td>
                    <td>{{approval_data.app_id}}</td>
                    <td>{{approval_data.recevied_time}}</td>
                    <td>{{approval_data.proc_time}}</td>
                    <td>{{approval_data.time_zone}}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table><br><br>
        </div>
        {% endif %}
    </div>
    <div style="height:30px; font-size:12px; text-align:right; padding-right:10px;" >© 2022 Hiranya-Garbha Consultancy. All rights reserved.</div>
</div>
{% include 'ProductDetailPopup/basic_product_detail_popup.html' %}
<script src="{% static 'scripts/manager-details.js' %}"></script>
<script>
    var GLOBAL_SELECT_ITEM_NUM = 0
    // Close action sections i item details table
    function closeAttachSection(obj, data) {
        item_number = data.substr(-1)
        var x = data;
        document.getElementById(x).style.display = "none"
        document.getElementById('item_info_tr-'+item_number).hidden = true;
    }

    // Function to hide and show hidden table row contents
    function showSection(obj, data) {
        item_number = data.split('-')[1]
        GLOBAL_SELECT_ITEM_NUM = item_number
        document.getElementById('item_info_tr-'+item_number).hidden = false;
        if (data.includes('attachments')) {
            get_attachment_IDB(item_number)
        }
        var dropdownContentClass = data;
        var rowId = document.getElementById(dropdownContentClass);
        var rowClass = rowId.className;
        var hideableRowSection = document.getElementsByClassName(rowClass);

        for (var i = 0; i < hideableRowSection.length; i++) {
            var current_element = hideableRowSection[i].id
            if (current_element == dropdownContentClass) {
                hideableRowSection[i].style.display = 'block';
            } else {
                hideableRowSection[i].style.display = 'none';
            }
        }
    }

    // Function to toggle note type textarea
    function selectNoteType(data) {
        var getNotebtnClass1 = data.className.split(" ")[0]
        var getNotebtnClass2 = data.className.split(" ")[1]
        var activeNoteBtn = document.getElementsByClassName(getNotebtnClass1);
        var noteBtnId = data.id
        var textareaId = document.getElementById(getNotebtnClass2);
        var textareaClass = textareaId.className;
        var hideableNoteText = document.getElementsByClassName(textareaClass);


        for (var i = 0; i < hideableNoteText.length; i++) {
            var current_element = hideableNoteText[i].id
            if (current_element == getNotebtnClass2) {
                hideableNoteText[i].style.display = 'block';
            } else {
                hideableNoteText[i].style.display = 'none';
            }
        }

        for (var i = 0; i < activeNoteBtn.length; i++) {
            var current_button = activeNoteBtn[i].id
            if (current_button==noteBtnId){
                activeNoteBtn[i].style.backgroundColor = '#007bff';
                activeNoteBtn[i].style.color = '#ffffff';
            } else{
                activeNoteBtn[i].style.backgroundColor = '#dbdad9';
                activeNoteBtn[i].style.color = '#000000';
            }
        }
    }

 function show_manager_detail(id) {
    sc_app_guid_data = {};
    sc_app_guid_data['guid'] = id;

    ajax_get_manager_detail(sc_app_guid_data)

    $('#manager_detail_body').empty();
    trHTML = '<tr></tr>';
    $.each(response, function (i, sc_app) {
        trHTML += '<tr><td>' + sc_app.fields.app_desc + '</td><td >' + sc_app.fields.step_num + '</td><td>' + sc_app.fields.proc_lvl_sts + '</td><td>' + sc_app.fields.app_sts + '</td><td>' + sc_app.fields.app_id + '</td><td>' + sc_app.fields.proc_time + '</td><td>' + sc_app.fields.received_time + '</td></tr>';
    });
    $('#manager_detail_body').append(trHTML);
    $('#manager-detail-popup').modal('show');

}

function ajax_get_manager_detail(data) {
    urlLink = "{% url 'eProc_Doc_Search:get_sc_app_data' %}";
    AjaxCallAPI(urlLink, data);
}
</script>
{% endblock %}

